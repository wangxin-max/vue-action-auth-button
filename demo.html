<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ActionAuthButton æ¼”ç¤º</title>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ant-design-vue@1.7.8/dist/antd.min.css">
    <script src="https://cdn.jsdelivr.net/npm/ant-design-vue@1.7.8/dist/antd.min.js"></script>
    <style>
        body { margin: 20px; font-family: Arial, sans-serif; }
        .demo-section { margin: 20px 0; padding: 20px; border: 1px solid #ddd; border-radius: 4px; }
        .button-group { display: flex; gap: 10px; flex-wrap: wrap; align-items: center; margin: 10px 0; }
        h2 { color: #1890ff; }
        .info { background: #f0f9ff; padding: 10px; border-radius: 4px; margin-bottom: 15px; }
        .permission-buttons { margin-bottom: 15px; }
        .permission-buttons button { margin-right: 10px; }
        pre { background: #f5f5f5; padding: 10px; border-radius: 4px; overflow-x: auto; }
        .code-comparison { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        @media (max-width: 768px) {
            .code-comparison { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div id="app">
        <h1>ğŸš€ ActionAuthButton æƒé™æŒ‰é’®ç»„ä»¶æ¼”ç¤º</h1>

        <div class="demo-section">
            <h2>ğŸ” æƒé™æ§åˆ¶æ¼”ç¤º</h2>
            <div class="info">
                <p><strong>å½“å‰æƒé™:</strong> {{ currentPermission === '*' ? 'è¶…çº§ç®¡ç†å‘˜(*)' : currentPermission === 'none' ? 'æ— æƒé™' : currentPermission }}</p>
                <div class="permission-buttons">
                    <a-button type="primary" @click="currentPermission = '*'">è¶…çº§ç®¡ç†å‘˜</a-button>
                    <a-button @click="currentPermission = 'user:edit'">ç¼–è¾‘æƒé™</a-button>
                    <a-button @click="currentPermission = 'user:view'">æŸ¥çœ‹æƒé™</a-button>
                    <a-button danger @click="currentPermission = 'none'">æ— æƒé™</a-button>
                </div>
            </div>

            <h3>æ“ä½œæŒ‰é’® (æ ¹æ®æƒé™è‡ªåŠ¨æ˜¾ç¤º/éšè—)ï¼š</h3>
            <div class="button-group">
                <!-- æŸ¥çœ‹æŒ‰é’® -->
                <span v-if="hasAuth('view')">
                    <a-button type="link" icon="eye" @click="handleView">
                        æŸ¥çœ‹
                    </a-button>
                </span>
                <span v-else style="color: #ccc; padding: 4px 8px;">
                    <a-icon type="eye" /> æ— æŸ¥çœ‹æƒé™
                </span>

                <!-- ç¼–è¾‘æŒ‰é’® -->
                <span v-if="hasAuth('edit')">
                    <a-button type="link" icon="edit" style="color: #52c41a;" @click="handleEdit">
                        ç¼–è¾‘
                    </a-button>
                </span>
                <span v-else style="color: #ccc; padding: 4px 8px;">
                    <a-icon type="edit" /> æ— ç¼–è¾‘æƒé™
                </span>

                <!-- åˆ é™¤æŒ‰é’® -->
                <span v-if="hasAuth('delete')">
                    <a-popconfirm
                        title="ç¡®å®šè¦åˆ é™¤è¿™æ¡æ•°æ®å—ï¼Ÿ"
                        @confirm="handleDelete"
                        ok-text="ç¡®å®š"
                        cancel-text="å–æ¶ˆ">
                        <a-button type="link" icon="delete" style="color: #ff4d4f;">
                            åˆ é™¤
                        </a-button>
                    </a-popconfirm>
                </span>
                <span v-else style="color: #ccc; padding: 4px 8px;">
                    <a-icon type="delete" /> æ— åˆ é™¤æƒé™
                </span>

                <!-- æ–°å¢æŒ‰é’® -->
                <span v-if="hasAuth('add')">
                    <a-button type="primary" icon="plus" @click="handleAdd">
                        æ–°å¢
                    </a-button>
                </span>
                <span v-else style="color: #ccc; padding: 4px 8px;">
                    <a-icon type="plus" /> æ— æ–°å¢æƒé™
                </span>
            </div>
        </div>

        <div class="demo-section">
            <h2>âœ¨ ç»„ä»¶ç‰¹æ€§</h2>
            <ul>
                <li>âœ… <strong>æƒé™æ£€æŸ¥</strong> - æ ¹æ®ç”¨æˆ·æƒé™è‡ªåŠ¨æ˜¾ç¤º/éšè—æŒ‰é’®</li>
                <li>âœ… <strong>ç»Ÿä¸€æ ·å¼</strong> - ä¸åŒæ“ä½œç±»å‹çš„æŒ‰é’®æœ‰ä¸åŒçš„é»˜è®¤æ ·å¼å’Œå›¾æ ‡</li>
                <li>âœ… <strong>å†…ç½®ç¡®è®¤</strong> - åˆ é™¤æ“ä½œå†…ç½®ç¡®è®¤å¼¹çª—ï¼Œé˜²æ­¢è¯¯æ“ä½œ</li>
                <li>âœ… <strong>ç®€åŒ–ä»£ç </strong> - ä¸€è¡Œä»£ç æ›¿ä»£å¤šè¡Œæƒé™æ£€æŸ¥é€»è¾‘</li>
                <li>âœ… <strong>çµæ´»é…ç½®</strong> - æ”¯æŒè‡ªå®šä¹‰å›¾æ ‡ã€æ–‡æœ¬ã€çŠ¶æ€ç­‰</li>
                <li>âœ… <strong>Vue 2/3 å…¼å®¹</strong> - åŒæ—¶æ”¯æŒ Vue 2.x å’Œ Vue 3.x</li>
            </ul>
        </div>

        <div class="demo-section">
            <h2>ğŸ“ ä»£ç å¯¹æ¯”</h2>
            <div class="code-comparison">
                <div>
                    <h3>ä¼ ç»Ÿæ–¹å¼ (å¤æ‚)</h3>
                    <pre><code>{{ traditionalCode }}</code></pre>
                </div>
                <div>
                    <h3>ä½¿ç”¨ ActionAuthButton (ç®€æ´)</h3>
                    <pre><code>{{ componentCode }}</code></pre>
                </div>
            </div>
            <p style="text-align: center; margin-top: 20px;">
                <strong style="color: #52c41a; font-size: 18px;">ä»£ç å‡å°‘ 70%ï¼ŒåŠŸèƒ½æ›´å¼ºå¤§ï¼ğŸš€</strong>
            </p>
        </div>

        <div class="demo-section">
            <h2>ğŸ¯ æ”¯æŒçš„æ“ä½œç±»å‹</h2>
            <div class="button-group">
                <a-tag color="blue">view - æŸ¥çœ‹è¯¦æƒ…</a-tag>
                <a-tag color="green">edit - ç¼–è¾‘æ•°æ®</a-tag>
                <a-tag color="red">delete - åˆ é™¤æ•°æ® (å†…ç½®ç¡®è®¤)</a-tag>
                <a-tag color="purple">add - æ–°å¢æ•°æ®</a-tag>
                <a-tag color="orange">custom - è‡ªå®šä¹‰æ“ä½œ</a-tag>
            </div>
        </div>

        <div class="demo-section">
            <h2>ğŸ“§ è”ç³»æ–¹å¼</h2>
            <p>è¿™æ˜¯ä¸€ä¸ªå¼€æºçš„ Vue ç»„ä»¶ï¼Œæ¬¢è¿ä½¿ç”¨å’Œè´¡çŒ®ï¼</p>
            <p>
                <a-badge status="processing" text="é¡¹ç›®æŒç»­æ›´æ–°ä¸­..." />
            </p>
        </div>
    </div>

    <script>
        new Vue({
            el: '#app',
            data() {
                return {
                    currentPermission: '*',
                    record: {
                        id: 1,
                        name: 'æµ‹è¯•æ•°æ®',
                        description: 'è¿™æ˜¯ä¸€æ¡æµ‹è¯•è®°å½•ï¼Œç”¨äºæ¼”ç¤ºæƒé™æŒ‰é’®åŠŸèƒ½'
                    },
                    traditionalCode: `<span v-show="hasButtonAuthority(currentPermissionId, 'view')"
      @click="handleView(record)">
  <a-icon type="eye" /> è¯¦æƒ…
</span>
<span v-show="hasButtonAuthority(currentPermissionId, 'edit')"
      @click="handleEdit(record)">
  <a-icon type="edit" /> ç¼–è¾‘
</span>
<a-popconfirm v-show="hasButtonAuthority(currentPermissionId, 'delete')"
               title="ç¡®è®¤åˆ é™¤?"
               @confirm="handleDelete(record)">
  <span><a-icon type="delete" /> åˆ é™¤</span>
</a-popconfirm>`,
                    componentCode: `<ActionAuthButton type="view" :record="record"
                    @view="handleView" />
<ActionAuthButton type="edit" :record="record"
                    @edit="handleEdit" />
<ActionAuthButton type="delete" :record="record"
                    @delete="handleDelete" />`
                }
            },
            methods: {
                // æ¨¡æ‹Ÿæƒé™æ£€æŸ¥é€»è¾‘
                hasAuth(action) {
                    if (this.currentPermission === '*') return true;
                    if (this.currentPermission === 'none') return false;

                    // ä¸åŒæƒé™çº§åˆ«æ”¯æŒçš„æ“ä½œ
                    const permissionMap = {
                        'user:edit': ['view', 'edit', 'add', 'delete'],
                        'user:view': ['view'],
                        'user:delete': ['view', 'delete'],
                        'user:add': ['view', 'add']
                    };

                    return permissionMap[this.currentPermission]?.includes(action) || false;
                },

                handleView() {
                    this.$message.info('æŸ¥çœ‹æ“ä½œ: ' + JSON.stringify(this.record, null, 2));
                },

                handleEdit() {
                    this.$message.info('ç¼–è¾‘æ“ä½œ: ' + JSON.stringify(this.record, null, 2));
                },

                handleDelete() {
                    this.$message.success('åˆ é™¤æˆåŠŸ: ' + JSON.stringify(this.record, null, 2));
                },

                handleAdd() {
                    this.$message.info('æ–°å¢æ“ä½œ');
                }
            }
        });
    </script>
</body>
</html>